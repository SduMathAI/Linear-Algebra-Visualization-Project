# 技术报告
## 一、提示词（System Prompt）

```plaintext
你是一个线性代数可视化辅助工具，需要处理用户关于线性代数的问题，并生成结构化响应。响应需包含以下核心要素：
1. 操作类型（operation）：如 "lean_intro"（Lean介绍）、"mat_mul"（矩阵乘法）等，用于指定系统后续处理方式
2. 输入数据（inputs）：根据操作类型提供必要参数，如矩阵数据、变换角度等
3. 可视化配置（visualization_config）：指定可视化相关参数，如是否显示网格（show_grid）、注释（comment）等
4. Lean相关内容（lean）：包含中文陈述（statement_cn）、非形式化描述（statement_informal）、Lean代码（lean_code）和提示（hint）
5. 解释说明（explanation）：对操作和结果进行自然语言解释
```

## 二、系统架构

本项目采用三层架构设计，整体结构如下：

1. 前端层
    - 负责用户交互界面展示
    - 实现线性代数概念的可视化渲染
    处理用户输入与结果展示
2. 后端层（核心）
    - 基于 Flask 框架构建 API 服务
    - 提供/chat接口处理用户请求
    - 集成 LLM（大语言模型）客户端，负责自然语言理解与响应生成
    - 实现与 Lean 定理证明器的交互逻辑
    - 数据验证与格式转换
3. 服务支持层
    - LLM 服务：处理自然语言理解与结构化响应生成
    - Lean 定理证明器：提供定理证明支持
    - 测试框架：基于单元测试确保系统稳定性
    - 架构交互流程：用户通过前端界面输入问题 → 前端将请求发送至后端/chat接口 → 后端调用 LLM 生成结构化响应 → 后端将处理后的结果返回给前端 → 前端根据响应进行可视化展示
## 三、模块功能

1. API 接口模块
    - 提供POST /chat接口，接收用户自然语言查询
    - 处理请求数据并返回 JSON 格式响应
    - 支持多种操作类型的统一入口处理
2. LLM 交互模块
    - 封装 LLM 客户端调用逻辑
    - 处理 LLM 返回结果，提取结构化数据
    - 支持 Markdown 格式响应的解析（如代码块中的 JSON 提取）
3. 可视化处理模块
    - 根据 `visualization_config` 参数配置可视化参数
    - 支持矩阵、向量变换等线性代数元素的可视化渲染控制
    - 提供网格显示、注释等辅助可视化功能
4. Lean 集成模块
    - 处理 Lean 相关内容的生成与展示
    - 提供定理的中文陈述、形式化证明代码
    - 支持 Lean 证明过程的解析与展示
5. 测试验证模块
    - 实现关键功能的单元测试（如 `test_lean_intro`、`test_rotation_matrix`）
    - 验证系统提示词的完整性
    - 确保 API 接口响应的正确性与稳定性
## 四、小组分工

- 项目经理（1 人）：吴叶轩
    - 负责项目整体规划与进度管理
    - 协调各模块开发与集成

- 前端开发（5 人）
    - 设计并实现用户交互界面,开发线性代数元素的可视化组件 ：刘瀚文 王宇坤
    - 实现前端与后端的通信逻辑、开发数据验证与处理逻辑 : 孙文博 闫百涵 刘翔
- 后端开发与Lean（3 人）
    - 算法与 LLM 集成 ： 崔添 房玉坤 周少鹏
    - 设计系统提示词与交互逻辑、优化 LLM 响应结果的准确性、负责 Lean 定理证明器的集成 ： 崔添

- 撰写技术报告与 答辩PPT（1 人）：左明冉

五、部署方法
1. 环境准备
    - 安装 Python 3.8 + 环境
    - 安装依赖包：`pip install flask openai unittest`
    - 配置环境变量：设置 OpenAI API 密钥等必要参数
2. 后端部署

```bash
# 克隆代码仓库
git clone <仓库地址>
cd Linear-Algebra-Visualization-Project-main/backend

# 启动Flask服务
flask run --host=0.0.0.0 --port=5000
# 或使用生产级服务器
gunicorn -w 4 -b 0.0.0.0:5000 "app:app"
```

3. 前端部署
    - 将前端静态文件部署至 Nginx 或其他 Web 服务器
    - 配置前端 API 请求地址指向后端服务
4. 容器化部署（推荐）
    - 编写 Dockerfile 构建前后端镜像
    - 使用 `docker-compose` 管理多容器部署
```yaml
# docker-compose.yml示例
version: '3'
services:
  backend:
    build: ./backend
    ports:
      - "5000:5000"
  frontend:
    build: ./frontend
    ports:
      - "80:80"
    depends_on:
      - backend
```
5. 测试验证
运行验证脚本：`python verify_agent.py`
确认所有测试用例通过后完成部署

## 附：组会记录

### 2025-12-8 第一次组会
自我介绍 确定选题 分工
（夹带私货）讲解 Lean

- PPT：左明冉
- Backend Lean Agent：崔添 房玉坤 周少鹏
- 可视化 Frontend：
	- 项目经理：吴叶轩
	- 逻辑：孙文博 闫百涵 刘翔
	- 页面：刘瀚文 王宇坤

### 2025-12-15 第二次组会
崔添 吴叶轩 主持交流了这一周的进展，吴叶轩合并了上周工作的代码（吴叶轩 崔添 孙文博）

崔添 讲解 Git 的使用方法，录制视频。
特别注意：
- push 时要创建 PR，而不是直接 push 到主分支。

#### 一些下一周需要改善的任务：

- （窗格是不是太大了
- 动画功能 （逻辑组）

（页面组）
- 对话框无法选择复制文字。
- 对话框还需要调，有一些混乱，分段不能良好显示。 
- 拖动条不太好拖动（吴叶轩组会期间已解决
- 滑块添加输入数值功能。
- 0.5 -> 自由调节，很难精确，需要添加吸附功能（吴叶轩组会期间已解决
- 加入撤回功能。

（后端组）
- llm prompt 的调试
- lean 模块删掉一些内容，简化 json 输出


### 2025-12-19 后端小组会
合并页面组（王宇坤 刘瀚文）的PR （崔添）
后端组（崔添 房玉坤 周少鹏）整理调试 Prompt 


### 2025-12-22 第三次组会
// TODOs：
1. 线性组合动画的前端问题 （王宇坤）
2. AI 窗口对 Markdown 的支持 （吴叶轩 刘瀚文）
3. （urgent）矩阵乘法几何意义 （逻辑组）
4. 奇异值分解的动画 （逻辑组）
5. Prompt PR（崔添 房玉坤）先删去所有和 Lean 有关的内容，再合并
6. PPT 技术报告 和 结项初步 （左明冉）

今天逻辑组工作比较困难，讨论较久。
决定将 矩阵乘法几何意义理解为 两个线性变换的符合。为了更好的直观表现，对其中的作用矩阵做 SVD 分解，分解为 旋转和伸缩矩阵。这样作用在另一个矩阵上，可以直观的展现矩阵的作用和矩阵的乘法。同时，我们拓展了动画功能，使得 SVD 分解后的矩阵也可以作用在向量上。	